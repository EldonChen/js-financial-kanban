# 技术路线 - 前端改版

> 本文档记录前端改版的任务拆解和进度跟踪，仅用于当前任务。

## 任务概述

将现有基础 dashboard 改造成管理台应用，支持快速添加新功能，并提前规划 BFF 数据接入层。

## 任务状态说明

- ✅ **已完成**：任务已完成
- 🚧 **进行中**：任务正在进行
- ⏸️ **阻塞中**：任务遇到阻塞，需要解决
- ⏳ **待开始**：任务尚未开始
- ❌ **已取消**：任务已取消

## 任务拆解

### Phase 1：基础架构搭建

#### 1.1 研究参考项目结构 ✅ 已完成
- **任务描述**：研究 https://github.com/dianprata/nuxt-shadcn-dashboard 项目结构
- **完成标准**：
  - ✅ 了解项目目录结构（使用 `app/` 目录）
  - ✅ 了解 shadcn/ui 组件在 Nuxt 中的集成方式
  - ✅ 了解布局和导航实现方式
  - ✅ 已更新技术方案设计（采用激进方案：直接复用参考项目结构）
- **依赖关系**：无
- **关键发现**：
  - 参考项目使用 `app/` 目录结构（Nuxt 3.8+）
  - 使用 TailwindCSS 4 + `@tailwindcss/vite`
  - 完整的布局组件系统（AppSidebar、Header 等）
  - 可直接复用的配置和工具函数

#### 1.2 重构项目结构并安装依赖 ⏳ 待开始
- **任务描述**：重构项目为 `app/` 目录结构，安装所有依赖
- **完成标准**：
  - 创建 `app/` 目录结构
  - 迁移现有文件到 `app/` 目录
  - 安装所有参考项目的依赖（shadcn-nuxt、reka-ui、TailwindCSS 4 等）
  - 从参考项目复制配置文件（components.json、app.config.ts）
  - 更新 `nuxt.config.ts`（移除 `@nuxtjs/tailwindcss`，添加 `@tailwindcss/vite`）
- **依赖关系**：1.1
- **注意事项**：
  - 使用激进方案，直接采用参考项目的结构
  - 确保所有依赖版本与参考项目一致
  - 迁移时保持现有 API 调用逻辑不变

#### 1.3 复用布局系统和组件 ⏳ 待开始
- **任务描述**：从参考项目复制布局系统和组件
- **完成标准**：
  - 从参考项目复制 `app/layouts/default.vue`
  - 从参考项目复制 `app/components/layout/` 目录（AppSidebar、Header 等）
  - 从参考项目复制 `app/composables/useAppSettings.ts`
  - 从参考项目复制 `app/lib/utils.ts`
  - 从参考项目复制 `app/assets/css/tailwind.css`
  - 从参考项目复制 `app/types/nav.ts`（导航类型定义）
- **依赖关系**：1.2
- **注意事项**：
  - 直接复用参考项目的代码，减少开发工作量
  - 后续根据需求进行适配

#### 1.4 安装 shadcn 组件并配置导航菜单 ⏳ 待开始
- **任务描述**：安装 shadcn 组件，配置导航菜单
- **完成标准**：
  - 使用 `shadcn-nuxt` CLI 安装基础组件（Button、Card、Sidebar 等）
  - 从参考项目复制 `app/constants/menus.ts` 并适配我们的菜单
  - 更新导航菜单配置，添加 Playground 相关菜单项
  - 确保侧边栏导航正常工作（展开/折叠、路由高亮等）
- **依赖关系**：1.3
- **注意事项**：
  - 导航菜单配置已包含在复用的组件中
  - 只需适配菜单内容，不需要重新实现导航逻辑

#### 1.5 迁移现有页面到新结构 ⏳ 待开始
- **任务描述**：迁移现有页面到 `app/pages/playground/` 目录
- **完成标准**：
  - 迁移现有页面到 `app/pages/playground/` 目录
  - 更新页面使用新布局（`definePageMeta({ layout: 'default' })`）
  - 更新页面内的路由链接（如果需要）
  - 确保所有页面功能正常
  - 迁移 API 调用到 `app/api/` 目录（保持结构不变）
- **依赖关系**：1.4
- **注意事项**：
  - 保持现有 API 调用逻辑不变
  - 页面会自动使用新布局
  - 确保所有功能正常工作

#### 1.6 更新首页和测试验证 ⏳ 待开始
- **任务描述**：更新首页，进行测试验证
- **完成标准**：
  - 更新 `app/pages/index.vue` 为管理台概览（可选，可后续完善）
  - 测试所有页面功能正常
  - 测试侧边栏导航、路由跳转等
  - 代码质量检查（编译通过、无错误）
- **依赖关系**：1.5
- **注意事项**：
  - 这是强制检查点
  - 确保所有功能正常工作
  - 可以后续再完善首页内容

### Phase 2：API 层重构

#### 2.1 设计 API 适配器接口 ⏳ 待开始
- **任务描述**：设计统一的 API 适配器接口
- **完成标准**：
  - 定义 `ApiAdapter` 接口
  - 定义 `ApiClient` 类
  - 定义统一的响应格式
  - 创建 `api/types.ts` 类型定义文件
- **依赖关系**：无（可并行进行）
- **注意事项**：
  - 接口设计要考虑后续 BFF 切换
  - 保持与现有 `useApi.ts` 的兼容性
  - 使用 TypeScript 严格类型

#### 2.2 实现 DirectAdapter ⏳ 待开始
- **任务描述**：实现直接调用后端服务的适配器
- **完成标准**：
  - 创建 `api/adapters/direct.ts`
  - 实现 `DirectAdapter` 类
  - 实现所有 HTTP 方法（GET、POST、PUT、DELETE）
  - 复用现有的 `useApi.ts` 逻辑
- **依赖关系**：2.1
- **注意事项**：
  - 保持与现有 API 调用方式一致
  - 确保错误处理正确
  - 支持请求拦截和响应拦截（可选）

#### 2.3 预留 BffAdapter 接口 ⏳ 待开始
- **任务描述**：预留 BFF 适配器接口（不实现具体逻辑）
- **完成标准**：
  - 创建 `api/adapters/bff.ts`
  - 定义 `BffAdapter` 类结构
  - 实现接口方法（返回占位实现）
  - 添加 TODO 注释说明后续实现
- **依赖关系**：2.1
- **注意事项**：
  - 接口要与 `DirectAdapter` 保持一致
  - 添加清晰的注释说明
  - 不实现具体逻辑，只预留接口

#### 2.4 创建统一 API 客户端 ⏳ 待开始
- **任务描述**：创建统一的 API 客户端
- **完成标准**：
  - 创建 `api/client.ts`
  - 实现 `ApiClient` 类
  - 支持切换适配器
  - 提供统一的 API 调用方法
- **依赖关系**：2.2, 2.3
- **注意事项**：
  - 使用依赖注入模式
  - 默认使用 `DirectAdapter`
  - 提供切换适配器的方法

#### 2.5 重构现有 API 调用 ⏳ 待开始
- **任务描述**：重构现有 API 调用，使用适配器模式
- **完成标准**：
  - 更新 `api/services/node.ts` 使用 `ApiClient`
  - 更新 `api/services/python.ts` 使用 `ApiClient`
  - 更新 `api/services/rust.ts` 使用 `ApiClient`
  - 确保所有 API 调用正常工作
- **依赖关系**：2.4
- **注意事项**：
  - 保持 API 接口不变（对外接口保持一致）
  - 确保所有页面功能正常
  - 测试所有 API 调用

### Phase 3：功能完善（可选）

#### 3.1 完善 Playground 页面 ⏳ 待开始
- **任务描述**：完善 Playground 页面样式和功能
- **完成标准**：
  - 统一 Playground 页面样式
  - 添加页面标题和描述
  - 优化用户体验
- **依赖关系**：1.6
- **注意事项**：
  - 保持简洁，避免过度设计
  - 可以后续再完善

#### 3.2 添加更多 UI 组件 ⏳ 待开始
- **任务描述**：根据需求添加更多 shadcn/ui 组件
- **完成标准**：
  - 添加需要的 UI 组件（Table、Dialog、Form 等）
  - 确保组件正常工作
- **依赖关系**：1.2
- **注意事项**：
  - 按需添加，不要一次性添加所有组件
  - 确保组件类型定义正确

#### 3.3 优化用户体验 ⏳ 待开始
- **任务描述**：优化整体用户体验
- **完成标准**：
  - 添加加载状态
  - 添加错误提示
  - 优化页面过渡动画
  - 响应式优化
- **依赖关系**：1.6, 2.5
- **注意事项**：
  - 保持简洁，避免过度动画
  - 确保性能不受影响

### Phase 4：文档和测试

#### 4.1 更新项目文档 ⏳ 待开始
- **任务描述**：更新项目文档，说明新的架构和使用方式
- **完成标准**：
  - 更新 `frontend/README.md`
  - 添加架构说明
  - 添加使用指南
  - 添加开发指南
- **依赖关系**：2.5
- **注意事项**：
  - 文档要清晰易懂
  - 包含代码示例
  - 说明如何添加新功能

#### 4.2 代码质量检查 ⏳ 待开始
- **任务描述**：进行代码质量检查
- **完成标准**：
  - 代码编译通过
  - 无 TypeScript 错误
  - 无 ESLint 错误
  - 所有功能正常工作
- **依赖关系**：2.5, 3.3
- **注意事项**：
  - 这是强制检查点
  - 必须通过才能继续

## 任务依赖关系图

```
Phase 1: 基础架构
1.1 → 1.2 → 1.3 → 1.4 → 1.5 → 1.6 → 1.7

Phase 2: API 层重构
2.1 → 2.2 ─┐
2.1 → 2.3 ─┼→ 2.4 → 2.5
            └─────────┘

Phase 3: 功能完善（可选）
1.6 → 3.1
1.2 → 3.2
1.6, 2.5 → 3.3

Phase 4: 文档和测试
2.5 → 4.1
2.5, 3.3 → 4.2
```

## 检查清单

### 开发前检查
- [ ] 已研究参考项目结构
- [ ] 已理解技术方案设计
- [ ] 已确认技术选型

### Phase 1 检查
- [ ] shadcn/ui 组件已安装和配置
- [ ] 布局系统已创建
- [ ] 侧边栏导航已实现
- [ ] 导航菜单配置已创建
- [ ] Playground 模块已创建，现有页面已迁移
- [ ] 首页已更新

### Phase 2 检查
- [ ] API 适配器接口已设计
- [ ] DirectAdapter 已实现
- [ ] BffAdapter 接口已预留
- [ ] 统一 API 客户端已创建
- [ ] 现有 API 调用已重构
- [ ] 所有 API 调用正常工作

### Phase 3 检查（可选）
- [ ] Playground 页面已完善
- [ ] 需要的 UI 组件已添加
- [ ] 用户体验已优化

### Phase 4 检查
- [ ] 项目文档已更新
- [ ] 代码质量检查已通过
- [ ] 所有功能正常工作

## 注意事项

1. **Keep it Simple**：优先实现核心功能，避免过度设计
2. **向后兼容**：确保现有功能在改版后仍能正常工作
3. **代码质量**：每个阶段完成后进行代码质量检查
4. **文档更新**：及时更新文档，保持与代码同步
5. **测试验证**：每个功能完成后进行测试验证

## 后续工作（不在本次任务范围）

1. **鉴权功能**：后续实现
2. **BFF 服务集成**：后续实现
3. **主题切换**：后续实现
4. **国际化**：后续实现
5. **性能优化**：后续实现
6. **单元测试和 E2E 测试**：后续实现
