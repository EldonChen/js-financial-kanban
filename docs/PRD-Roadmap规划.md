# PRD - Roadmap 规划

> **文档版本**：v1.2  
> **创建时间**：2025-01-06  
> **最后更新**：2025-01-20  
> **适用项目**：js-financial-kanban

## 1. Roadmap 概览

### 1.1 时间线

```
2025 Q1 (1-3月)         2025 Q2 (4-6月)         2025 Q3 (7-9月)         2025 Q4 (10-12月)
    │                        │                        │                        │
    ├─ Phase 1              ├─ Phase 2              ├─ Phase 3              ├─ Phase 4
    │  MVP 核心功能          │  功能完善              │  量化算法与回测        │  算法平台与实盘
    │  (已完成)              │  (进行中)              │  (规划中)              │  (规划中)
    │                        │                        │                        │
    └────────────────────────┴────────────────────────┴────────────────────────┴──────────────→
```

### 1.2 阶段划分

- **Phase 1：MVP 核心功能**（已完成）
- **Phase 2：功能完善**（进行中）
- **Phase 3：量化交易算法与回测**（规划中）
- **Phase 4：量化交易算法平台与实盘交易**（规划中）

---

## 2. Phase 1：MVP 核心功能（已完成）

**时间范围**：2024 Q4 - 2025 Q1  
**状态**：✅ 已完成

### 2.1 目标

构建最小可行产品（MVP），提供核心功能，验证技术架构可行性。

### 2.2 交付内容

#### 2.2.1 技术架构 ✅

- ✅ **多语言后端服务**：
  - Python FastAPI 服务（Items CRUD）
  - Node.js Nest.js 服务（Items CRUD）
  - Rust Axum 服务（Items CRUD）
  - Python 股票信息服务（多数据源支持）

- ✅ **BFF 层**：
  - Dashboard 视图（数据聚合）
  - Items 视图（数据聚合）
  - Stocks 视图（数据聚合）

- ✅ **前端基础**：
  - Nuxt.js 4 项目初始化
  - Shadcn UI 组件库集成
  - 基础布局和导航

#### 2.2.2 核心功能 ✅

- ✅ **股票信息管理**：
  - 股票查询（列表、详情、筛选）
  - 股票更新（单个、批量、全量）
  - 股票删除（单个、批量、全量）

- ✅ **多数据源支持**：
  - akshare（A股）
  - yfinance（美股/港股）
  - easyquotation（A股实时）
  - 自动容错和切换

- ✅ **实时同步**：
  - SSE 实时进度推送
  - 批量更新进度追踪

- ✅ **数据聚合**：
  - BFF 层聚合多个服务数据
  - 统一数据格式

### 2.3 与现有系统能力的复用关系

- **复用**：
  - 复用现有的三个后端服务（Python/Node/Rust）
  - 复用现有的股票信息服务
  - 复用现有的 BFF 层架构

- **新增**：
  - 新增前端页面（Dashboard、Stocks List、Stock Detail）
  - 新增批量更新功能的前端界面
  - 新增 SSE 进度追踪的前端实现

### 2.4 验收标准

- ✅ 所有后端服务正常运行
- ✅ BFF 层可以聚合数据
- ✅ 前端可以调用 BFF 接口
- ✅ 股票信息管理功能完整
- ✅ 多数据源支持正常

---

## 3. Phase 2：功能完善（进行中）

**时间范围**：2025 Q1 - Q2  
**状态**：🚧 进行中

### 3.1 目标

完善核心功能，提升用户体验，增强系统稳定性。

### 3.2 交付内容

#### 3.2.1 前端页面开发 ✅

- [x] **Dashboard 页面**：
  - [x] 统计数据展示（Total Items、Total Stocks）
  - [x] 最近 Items 列表
  - [x] 最近 Stocks 列表
  - [x] 数据刷新功能
  - [ ] 时间范围选择（待实现）

- [x] **Stocks 列表页**：
  - [x] 股票列表展示（表格）
  - [x] 搜索功能（按代码、名称）
  - [x] 筛选功能（按市场、行业）
  - [x] 排序功能（按更新时间、市值）
  - [x] 分页功能
  - [x] 批量操作（批量更新、批量删除）

- [x] **Stock 详情页**：
  - [x] 股票详细信息展示
  - [x] 基本信息（代码、名称、市场）
  - [x] 财务指标（市值、P/E、P/B、股息率）
  - [x] 数据源信息
  - [x] 更新/删除操作

- [x] **批量更新页**：
  - [x] 更新选项（全量更新）
  - [x] 延迟设置
  - [x] 实时进度展示（SSE）
  - [x] 进度可视化（进度条、统计信息）
  - [x] 错误处理和重试

#### 3.2.2 功能增强 🚧

- [ ] **数据源扩展**：
  - [ ] 接入 Tushare（A股备用数据源）
  - [ ] 接入 IEX Cloud（美股备用数据源）
  - [ ] 接入 Alpha Vantage（美股备用数据源）

- [ ] **性能优化**：
  - [ ] 添加 Redis 缓存（可选）
  - [ ] 优化数据库查询
  - [ ] 优化 BFF 层聚合性能

- [ ] **错误处理**：
  - [ ] 统一错误响应格式
  - [ ] 完善错误提示
  - [ ] 降级处理策略

#### 3.2.3 测试和文档 🚧

- [ ] **单元测试**：
  - [ ] 前端组件测试
  - [ ] BFF 层服务测试
  - [ ] 后端服务测试

- [ ] **集成测试**：
  - [ ] 端到端测试
  - [ ] API 集成测试

- [ ] **文档完善**：
  - [ ] API 文档
  - [ ] 用户手册
  - [ ] 开发文档

### 3.3 优先级

**P0 - 必须完成**：
- Dashboard 页面
- Stocks 列表页
- Stock 详情页
- 批量更新页

**P1 - 重要**：
- 数据源扩展
- 性能优化
- 错误处理

**P2 - 可选**：
- 测试覆盖
- 文档完善

### 3.4 验收标准

- [x] 所有核心页面可以正常访问 ✅
- [x] 股票信息管理功能完整可用 ✅
- [x] 批量更新功能正常，进度追踪准确 ✅
- [x] 系统性能满足要求（响应时间 < 500ms）✅
- [x] 错误处理完善，用户体验良好 ✅

**Phase 2 前端页面开发部分已完成**（2025-01-11）

---

## 4. Phase 3：量化交易算法与回测（规划中）

**时间范围**：2025 Q2 - Q3  
**状态**：🔮 规划中

### 4.1 目标

提供预设量化交易算法和完整的回测能力，构建量化交易基础能力。

### 4.2 交付内容

#### 4.2.1 数据支持模块 🚧 **P0 - 最高优先级（进行中）**

> **说明**：数据支持是量化交易和回测的基础，必须优先完成。没有可靠的历史数据和技术指标，无法进行有效的回测和算法开发。
> 
> **实现状态**：
> - ✅ 前端基础已完成（2025-01-20）：历史数据查询和技术指标计算已集成到股票详情页
> - ✅ BFF 层已完成（2025-01-20）：历史数据视图（6个接口）+ 技术指标视图（4个接口）
> - 🚧 后端服务进行中（2025-01-20）：已拆分为4个 Vibe-Kanban 任务，正在实施

**Vibe-Kanban 任务管理**：

数据支持模块的后台服务层已拆分为 **4个独立可验证的功能模块任务**，已在 vibe-kanban 中创建：

| 任务 | 任务ID | 状态 | 包含内容 | 依赖 |
|------|--------|------|----------|------|
| **任务1：数据模型和历史数据服务实现** | `4f980cc7-6edf-4db6-9411-c15a8b57b4fe` | 待开始 | MongoDB TimeSeries Collection 数据模型 + 历史K线数据获取、存储、查询、更新、删除功能 | 无 |
| **任务2：技术指标服务实现** | `005049e7-45cf-4159-a8ee-b4f3ed2ea4ff` | 待开始 | 技术指标计算引擎（TA-Lib/pandas-ta）+ 基础指标计算（MA、EMA、RSI、MACD、BOLL）+ 指标存储和查询功能 | 任务1 |
| **任务3：数据质量和同步服务实现** | `87678c0f-14a6-4332-a8fb-e1c234356571` | 待开始 | 数据完整性、准确性、一致性检查 + 定时任务管理（APScheduler）+ 数据同步机制 | 任务1 |
| **任务4：API 路由和服务集成** | `175e2dbb-28e6-471d-8a7a-6c798b13fb94` | 待开始 | 历史数据 API（6个接口）+ 技术指标 API（4个接口）+ 数据质量和同步 API + 服务集成 + 单元测试 + 与BFF层联调 | 任务1、2、3 |

**推荐执行顺序**：
1. 先执行任务1（数据模型和历史数据服务）- 这是核心基础
2. 并行执行任务2和任务3（技术指标服务、数据质量和同步服务）- 它们都依赖任务1，但彼此独立
3. 最后执行任务4（API 路由和服务集成）- 集成所有服务

**详细技术路线**：参见 `docs/技术路线-数据支持模块-服务层.md`

##### 4.2.1.1 历史K线数据获取与存储

- [x] **前端界面实现**：✅
  - [x] K线图可视化组件（ECharts）
  - [x] 时间周期选择器（分时、日K、周K、月K 等）
  - [x] 数据查询界面（集成到股票详情页）
  - [x] 数据更新功能（SSE 进度展示）
  - [x] Mock 数据支持（可独立开发和测试）

- [ ] **数据源集成**（待实现）：
  - [ ] 集成 yfinance 获取历史K线数据（美股、港股）
  - [ ] 集成 akshare 获取历史K线数据（A股、美股、港股）
  - [ ] 支持多数据源容错和切换
  - [ ] 支持增量数据更新

- [ ] **数据获取功能**（待实现）：
  - [ ] 单只股票历史数据获取（支持自定义时间范围）
  - [ ] 批量股票历史数据获取（支持股票列表）
  - [ ] 全量股票历史数据获取（支持按市场筛选）
  - [ ] 支持多时间周期（1分钟、5分钟、15分钟、30分钟、60分钟、日线、周线、月线）
  - [ ] 支持数据重试机制（网络失败自动重试）
  - [ ] 支持数据获取进度追踪（SSE 实时推送）

- [ ] **数据存储设计**（待实现）：
  - [ ] MongoDB 数据模型设计（K线数据集合结构）
  - [ ] 数据索引优化（按股票代码、日期、时间周期索引）
  - [ ] 数据分区策略（按市场、按时间分区）
  - [ ] 数据压缩存储（可选，节省存储空间）

- [ ] **数据管理功能**（待实现）：
  - [ ] 数据查询接口（按股票、时间范围、周期查询）
  - [ ] 数据更新接口（增量更新、全量更新）
  - [ ] 数据删除接口（清理过期数据）
  - [ ] 数据统计接口（数据覆盖范围、数据量统计）

##### 4.2.1.2 历史数据质量保证 ⏸️ **（暂缓实施）**

> **说明**：数据质量检查功能暂缓实施，优先完成核心的历史数据和技术指标功能。

- [ ] **数据质量检查**：
  - [ ] 数据完整性检查（缺失数据检测）
  - [ ] 数据准确性检查（异常值检测、价格合理性检查）
  - [ ] 数据一致性检查（开盘价、收盘价、最高价、最低价逻辑检查）
  - [ ] 数据重复检查（去重处理）

- [ ] **数据修复机制**：
  - [ ] 自动数据修复（缺失数据自动补全）
  - [ ] 数据修复记录（记录修复历史）
  - [ ] 数据修复通知（修复结果通知）

- [ ] **数据验证**：
  - [ ] 数据格式验证（字段类型、必填字段）
  - [ ] 数据范围验证（价格、成交量范围）
  - [ ] 数据时间验证（时间顺序、时间范围）

##### 4.2.1.3 技术指标计算 🚧 **（部分完成）**

> **实现状态**：前端界面已完成，支持多指标选择和叠加显示。后端计算引擎待实现。

- [x] **前端界面实现**：✅
  - [x] 指标选择器组件（支持多选）
  - [x] 指标图表组件（主图指标和附图指标）
  - [x] 指标叠加显示（在 K线图上）
  - [x] 智能指标计算（选择时自动检查和计算）
  - [x] 支持的指标列表展示

- [ ] **基础技术指标**（待实现）：
  - [ ] **移动平均线（MA）**：
    - [ ] MA5、MA10、MA20、MA30、MA60、MA120、MA250
    - [ ] EMA（指数移动平均线）
    - [ ] WMA（加权移动平均线）
  - [ ] **相对强弱指标（RSI）**：
    - [ ] RSI6、RSI12、RSI24
    - [ ] RSI 超买超卖信号
  - [ ] **MACD 指标**：
    - [ ] DIF、DEA、MACD 柱
    - [ ] MACD 金叉死叉信号
  - [ ] **布林带（Bollinger Bands）**：
    - [ ] 上轨、中轨、下轨
    - [ ] 布林带宽度
    - [ ] 布林带突破信号

- [ ] **高级技术指标**（待实现）：
  - [ ] **KDJ 指标**：K值、D值、J值
  - [ ] **OBV 指标**：能量潮指标
  - [ ] **CCI 指标**：商品通道指标
  - [ ] **ATR 指标**：平均真实波幅
  - [ ] **威廉指标（WR）**：威廉超买超卖指标
  - [ ] **成交量指标**：成交量移动平均、量比

- [ ] **技术指标计算引擎**（待实现）：
  - [ ] 指标计算服务（Python 服务，使用 pandas、numpy、talib）
  - [ ] 指标计算接口（按股票、时间范围、指标类型计算）
  - [ ] 批量指标计算（支持多股票、多指标批量计算）
  - [ ] 指标计算缓存（缓存计算结果，提升性能）

- [ ] **技术指标数据管理**（待实现）：
  - [ ] 指标数据存储（MongoDB 存储指标数据）
  - [ ] 指标数据查询（按股票、指标类型、时间范围查询）
  - [ ] 指标数据更新（增量更新、全量更新）
  - [x] 指标数据可视化（前端图表展示）✅

##### 4.2.1.4 数据服务接口 🚧 **（部分完成）**

> **实现状态**：前端 API 封装和 Mock 数据已完成，BFF 层和后端服务待实现。

- [x] **前端 API 封装**：✅
  - [x] HistoricalDataService - 历史数据服务封装
  - [x] IndicatorsService - 技术指标服务封装
  - [x] Composables 封装（useHistoricalData, useIndicators, useStockHistory）
  - [x] Mock 数据支持（Mock BFF 适配器，Mock 数据生成器）

- [ ] **后端服务开发**（待实现）：
  - [ ] 历史数据服务（Python 服务，扩展现有股票信息服务）
  - [ ] 技术指标服务（Python 服务，新增服务或扩展现有服务）
  - [ ] 数据管理接口（数据查询、更新、删除、统计）
  - [ ] 数据获取接口（单只、批量、全量数据获取）

- [ ] **BFF 层集成**（待实现）：
  - [ ] 历史数据视图（聚合历史数据接口）
  - [ ] 技术指标视图（聚合技术指标接口）
  - [ ] 数据统计视图（数据覆盖范围、数据量统计）

- [x] **前端界面开发**：✅
  - [x] 历史数据查询界面（集成到股票详情页）
  - [x] 技术指标选择和展示（支持多指标叠加）
  - [x] K线图和指标图表可视化

##### 4.2.1.5 数据同步与更新 ⏸️ **（暂缓实施）**

> **说明**：数据同步管理功能暂缓实施，优先完成核心的历史数据和技术指标功能。

- [ ] **定时任务**：
  - [ ] 每日数据同步任务（定时获取最新K线数据）
  - [ ] 增量数据更新（只更新缺失的数据）
  - [ ] 数据质量检查任务（定时检查数据质量）
  - [ ] 数据修复任务（自动修复数据问题）

- [ ] **数据同步策略**：
  - [ ] 按市场同步（A股、港股、美股分别同步）
  - [ ] 按优先级同步（重要股票优先同步）
  - [ ] 同步失败重试（自动重试机制）
  - [ ] 同步进度追踪（SSE 实时推送）

##### 4.2.1.6 实时交易情况获取 🔮 **P1 - 重要**

> **说明**：实时交易情况获取是量化交易和实盘交易的重要基础，但实现复杂度较高，优先级设为P1。该功能需要支持实时行情推送、交易数据订阅、连接管理等。

##### 4.2.1.6.1 实时行情数据获取

- [ ] **数据源集成**：
  - [ ] 集成 easyquotation 获取 A股实时行情（已支持，需扩展）
  - [ ] 集成 yfinance 获取美股/港股实时行情（WebSocket 或轮询）
  - [ ] 集成 akshare 获取 A股实时行情（备用数据源）
  - [ ] 支持多数据源容错和切换
  - [ ] 支持数据源健康检查（连接状态、数据延迟检测）

- [ ] **实时行情数据类型**：
  - [ ] **基础行情数据**：
    - [ ] 最新价（Last Price）
    - [ ] 涨跌幅（Change Percent）
    - [ ] 涨跌额（Change Amount）
    - [ ] 成交量（Volume）
    - [ ] 成交额（Amount）
    - [ ] 开盘价（Open Price）
    - [ ] 最高价（High Price）
    - [ ] 最低价（Low Price）
    - [ ] 昨收价（Previous Close）
  - [ ] **五档买卖盘数据**：
    - [ ] 买一至买五（Bid Price 1-5, Bid Volume 1-5）
    - [ ] 卖一至卖五（Ask Price 1-5, Ask Volume 1-5）
  - [ ] **逐笔成交数据**（可选）：
    - [ ] 成交时间戳
    - [ ] 成交价格
    - [ ] 成交数量
    - [ ] 买卖方向（主动买入/主动卖出）

- [ ] **实时数据获取方式**：
  - [ ] **WebSocket 推送**（优先）：
    - [ ] WebSocket 连接管理（连接建立、重连、心跳检测）
    - [ ] 订阅/取消订阅机制（按股票代码订阅）
    - [ ] 数据推送频率控制（可配置推送间隔）
    - [ ] 数据压缩（可选，减少网络传输）
  - [ ] **轮询方式**（备用）：
    - [ ] 定时轮询（可配置轮询间隔，默认1-5秒）
    - [ ] 智能轮询（根据市场活跃度调整轮询频率）
    - [ ] 批量轮询（一次请求多只股票数据）

##### 4.2.1.6.2 实时数据订阅与管理

- [ ] **订阅机制**：
  - [ ] 单只股票订阅（订阅指定股票代码）
  - [ ] 批量股票订阅（订阅股票列表）
  - [ ] 市场订阅（订阅整个市场，如A股、美股）
  - [ ] 自定义订阅（按行业、市值、涨跌幅等条件订阅）
  - [ ] 订阅优先级管理（重要股票优先推送）

- [ ] **订阅管理功能**：
  - [ ] 订阅列表管理（查看当前订阅的股票）
  - [ ] 订阅状态查询（订阅是否生效、数据是否正常）
  - [ ] 订阅配置管理（推送频率、数据类型配置）
  - [ ] 订阅历史记录（订阅变更历史）

- [ ] **数据推送策略**：
  - [ ] 全量推送（每次推送完整数据）
  - [ ] 增量推送（只推送变化的数据，减少网络传输）
  - [ ] 按需推送（根据客户端需求推送）
  - [ ] 推送频率控制（可配置推送间隔，避免过于频繁）

##### 4.2.1.6.3 实时数据存储与缓存

- [ ] **数据存储设计**：
  - [ ] MongoDB 实时数据集合（存储最新行情数据）
  - [ ] Redis 缓存（存储热点数据，提升查询性能）
  - [ ] 数据过期策略（实时数据自动过期，保留最新数据）
  - [ ] 数据归档策略（历史实时数据归档到历史K线数据）

- [ ] **数据缓存策略**：
  - [ ] 热点数据缓存（热门股票数据缓存）
  - [ ] 缓存更新机制（实时更新缓存）
  - [ ] 缓存失效策略（数据过期自动失效）
  - [ ] 缓存预热（系统启动时预热热点数据）

- [ ] **数据查询接口**：
  - [ ] 单只股票实时数据查询
  - [ ] 批量股票实时数据查询
  - [ ] 市场实时数据查询（按市场、行业等）
  - [ ] 历史实时数据查询（查询指定时间点的实时数据）

##### 4.2.1.6.4 WebSocket 服务与连接管理

- [ ] **WebSocket 服务设计**：
  - [ ] WebSocket 服务器（Python FastAPI WebSocket 或 Node.js WebSocket）
  - [ ] 连接认证（Token 认证、用户权限验证）
  - [ ] 连接状态管理（连接建立、断开、重连）
  - [ ] 心跳检测机制（保持连接活跃，检测连接状态）

- [ ] **连接管理功能**：
  - [ ] 连接池管理（管理多个客户端连接）
  - [ ] 连接限流（限制单个IP/用户的连接数）
  - [ ] 连接监控（监控连接数、连接状态、数据推送量）
  - [ ] 连接异常处理（连接断开自动重连、异常连接清理）

- [ ] **消息协议设计**：
  - [ ] 订阅消息格式（订阅请求、取消订阅请求）
  - [ ] 推送消息格式（行情数据推送、错误消息）
  - [ ] 心跳消息格式（心跳请求、心跳响应）
  - [ ] 消息序列化（JSON 或 MessagePack）

##### 4.2.1.6.5 实时数据服务接口

- [ ] **后端服务开发**：
  - [ ] 实时数据服务（Python 服务，扩展现有股票信息服务）
  - [ ] WebSocket 服务（实时数据推送服务）
  - [ ] 数据订阅管理接口（订阅、取消订阅、查询订阅）
  - [ ] 实时数据查询接口（RESTful API，查询最新行情）

- [ ] **BFF 层集成**：
  - [ ] 实时数据视图（聚合实时数据接口）
  - [ ] WebSocket 代理（BFF 层 WebSocket 代理，统一管理连接）
  - [ ] 数据订阅管理视图（订阅管理接口）

- [ ] **前端界面开发**：
  - [ ] 实时行情展示页（实时价格、涨跌幅、成交量等）
  - [ ] 五档买卖盘展示（买卖盘数据可视化）
  - [ ] 实时数据订阅管理页（订阅管理、配置）
  - [ ] 实时数据监控页（连接状态、数据推送状态）

##### 4.2.1.6.6 性能优化与容错

- [ ] **性能优化**：
  - [ ] 数据压缩（WebSocket 消息压缩，减少网络传输）
  - [ ] 批量推送（合并多个股票数据，减少推送次数）
  - [ ] 数据过滤（只推送订阅的数据，过滤无关数据）
  - [ ] 连接复用（多个客户端共享连接，减少连接数）

- [ ] **容错机制**：
  - [ ] 数据源故障切换（主数据源故障自动切换备用数据源）
  - [ ] 连接断开重连（自动重连机制，指数退避策略）
  - [ ] 数据丢失检测（检测数据是否丢失，自动补全）
  - [ ] 降级策略（WebSocket 失败时降级到轮询方式）

- [ ] **监控与告警**：
  - [ ] 连接监控（连接数、连接状态、连接延迟）
  - [ ] 数据推送监控（推送量、推送延迟、推送成功率）
  - [ ] 数据源监控（数据源状态、数据延迟、数据质量）
  - [ ] 异常告警（连接异常、数据异常、服务异常告警）

##### 4.2.1.6.7 实时数据应用场景

- [ ] **量化交易场景**：
  - [ ] 实时策略信号生成（基于实时行情生成交易信号）
  - [ ] 实时风控监控（实时监控持仓风险）
  - [ ] 实时订单执行（基于实时行情执行订单）

- [ ] **数据展示场景**：
  - [ ] 实时行情看板（实时展示股票行情）
  - [ ] 实时价格预警（价格达到阈值时推送通知）
  - [ ] 实时交易监控（监控交易状态、成交情况）

- [ ] **数据分析场景**：
  - [ ] 实时数据分析（实时计算技术指标、统计分析）
  - [ ] 实时数据对比（对比不同股票的实时表现）
  - [ ] 实时数据可视化（实时图表展示）

#### 4.2.2 回测引擎 🔮 **P0 - 必须完成**

> **说明**：回测引擎是量化交易的核心能力，依赖数据支持模块提供的历史数据和技术指标。

- [ ] **回测核心功能**：
  - [ ] 历史数据回测引擎（基于历史K线数据）
  - [ ] 支持多时间周期（日线、周线、月线）
  - [ ] 支持自定义回测参数：
    - [ ] 起始资金
    - [ ] 手续费率
    - [ ] 滑点设置
    - [ ] 回测时间范围
  - [ ] 支持多策略组合回测
  - [ ] 回测结果存储和管理

- [ ] **回测分析功能**：
  - [ ] **收益分析**：
    - [ ] 总收益、年化收益
    - [ ] 夏普比率
    - [ ] 最大回撤
    - [ ] 收益曲线
  - [ ] **风险分析**：
    - [ ] 波动率
    - [ ] VaR（风险价值）
    - [ ] 最大回撤
    - [ ] 回撤曲线
  - [ ] **交易分析**：
    - [ ] 交易次数统计
    - [ ] 胜率分析
    - [ ] 平均持仓时间
    - [ ] 盈亏分布
  - [ ] **可视化图表**：
    - [ ] 收益曲线图
    - [ ] 回撤曲线图
    - [ ] 持仓分布图
    - [ ] 交易信号图

#### 4.2.3 预设量化交易算法 🔮 **P0 - 必须完成**

> **说明**：预设算法是量化交易的基础，依赖数据支持模块提供的技术指标。

- [ ] **算法库开发**：
  - [ ] 提供 10+ 预设量化投资算法：
    - [ ] 均线策略（MA Strategy）
    - [ ] 动量策略（Momentum Strategy）
    - [ ] 均值回归策略（Mean Reversion Strategy）
    - [ ] 配对交易策略（Pairs Trading Strategy）
    - [ ] 统计套利策略（Statistical Arbitrage）
    - [ ] 布林带策略（Bollinger Bands Strategy）
    - [ ] RSI 策略（RSI Strategy）
    - [ ] MACD 策略（MACD Strategy）
    - [ ] 双均线交叉策略（Dual MA Crossover）
    - [ ] 网格交易策略（Grid Trading Strategy）
    - [ ] 更多策略（根据需求扩展）

- [ ] **算法管理**：
  - [ ] 算法列表展示
  - [ ] 算法详情查看
  - [ ] 算法参数配置
  - [ ] 算法版本管理

#### 4.2.4 量化交易服务 🔮 **P1 - 重要**

- [ ] **后端服务开发**：
  - [ ] 量化交易服务（Python/Node.js）
  - [ ] 算法执行引擎
  - [ ] 回测引擎
  - [ ] 数据接口（历史数据、实时数据）

- [ ] **前端界面开发**：
  - [ ] 算法列表页
  - [ ] 算法详情页
  - [ ] 回测配置页
  - [ ] 回测结果页
  - [ ] 回测分析页

### 4.3 优先级

**P0 - 必须完成**（按执行顺序）：
1. **数据支持模块**（最高优先级）：
   - 历史K线数据获取与存储
   - 历史数据质量保证
   - 技术指标计算
   - 数据服务接口
   - 数据同步与更新
2. **回测引擎**（依赖数据支持）：
   - 回测核心功能
   - 回测分析功能
3. **预设量化交易算法**（依赖数据支持和技术指标）：
   - 算法库开发（10+ 算法）
   - 算法管理

**P1 - 重要**：
- **实时交易情况获取**（数据支持模块扩展）：
  - 实时行情数据获取（WebSocket/轮询）
  - 实时数据订阅与管理
  - WebSocket 服务与连接管理
  - 实时数据存储与缓存
  - 性能优化与容错
- 量化交易服务（后端服务、前端界面）
- 回测可视化图表
- 多策略组合回测

**P2 - 可选**：
- 算法版本管理
- 高级回测参数

### 4.4 验收标准

**数据支持模块**（P0 + P1）：
- [ ] 历史K线数据可以正常获取和存储（支持多市场、多周期）
- [ ] 数据质量检查机制正常，数据修复功能可用
- [ ] 技术指标计算功能完整（基础指标和高级指标）
- [ ] 数据服务接口正常，支持查询、更新、删除
- [ ] 数据同步任务正常运行，支持增量更新
- [ ] **实时交易情况获取**（P1）：
  - [ ] 实时行情数据可以正常获取（WebSocket/轮询）
  - [ ] 实时数据订阅机制正常，支持订阅/取消订阅
  - [ ] WebSocket 服务正常，连接管理功能可用
  - [ ] 实时数据存储和缓存正常，查询性能满足要求
  - [ ] 容错机制正常，数据源故障可以自动切换

**回测引擎**（P0）：
- [ ] 回测引擎可以正常运行，支持历史数据回测
- [ ] 回测分析功能完整（收益、风险、交易分析）
- [ ] 回测可视化图表正常显示
- [ ] 系统性能满足要求（回测速度 < 1 分钟，单策略）

**预设算法**（P0）：
- [ ] 提供 10+ 预设量化投资算法
- [ ] 算法可以正常运行回测
- [ ] 算法参数配置功能正常

---

## 5. Phase 4：量化交易算法平台与实盘交易（规划中）

**时间范围**：2025 Q3 - Q4  
**状态**：🔮 规划中

### 5.1 目标

构建量化交易算法平台，支持用户自定义算法编辑和运行，并提供实盘交易能力。

### 5.2 交付内容

#### 5.2.1 量化交易算法平台 🔮

- [ ] **算法编辑器**：
  - [ ] 在线代码编辑器（支持 Python、JavaScript）
  - [ ] 代码高亮和自动补全
  - [ ] 语法检查
  - [ ] 代码模板和示例

- [ ] **算法管理**：
  - [ ] 用户自定义算法创建和编辑
  - [ ] 算法版本管理（Git 集成）
  - [ ] 算法分享和协作
  - [ ] 算法市场（可选）

- [ ] **算法执行**：
  - [ ] 算法运行环境（沙箱）
  - [ ] 算法调试和测试
  - [ ] 算法性能监控
  - [ ] 算法日志和错误处理

- [ ] **开放 API**：
  - [ ] 算法编辑 API
  - [ ] 算法运行 API
  - [ ] 回测 API
  - [ ] 数据获取 API
  - [ ] API 文档和 SDK

#### 5.2.2 实盘交易能力 🔮

- [ ] **券商 API 集成**：
  - [ ] 支持主流券商 API（如富途、盈透证券、Interactive Brokers 等）
  - [ ] 统一交易接口抽象
  - [ ] 多券商支持（可切换）

- [ ] **交易执行引擎**：
  - [ ] 订单管理（下单、撤单、查询）
  - [ ] 持仓管理
  - [ ] 资金管理
  - [ ] 交易风控（止损、止盈、仓位控制）

- [ ] **实盘交易功能**：
  - [ ] 策略回测后直接部署到实盘
  - [ ] 实盘交易监控
  - [ ] 交易记录和统计
  - [ ] 模拟交易和实盘交易切换

- [ ] **风控管理**：
  - [ ] 风险参数设置
  - [ ] 实时风险监控
  - [ ] 风险预警和通知
  - [ ] 自动止损和风控规则

#### 5.2.3 用户系统 🔮

- [ ] **用户认证**：
  - [ ] 用户注册/登录
  - [ ] JWT Token 认证
  - [ ] 密码重置

- [ ] **权限管理**：
  - [ ] 角色和权限
  - [ ] 数据隔离（用户算法、交易记录）
  - [ ] 操作审计

- [ ] **个人设置**：
  - [ ] 用户偏好配置
  - [ ] 通知设置
  - [ ] 交易设置（券商账户绑定）

#### 5.2.4 高级功能 🔮

- [ ] **股票组合管理**：
  - [ ] 创建股票组合
  - [ ] 组合分析
  - [ ] 组合对比

- [ ] **价格预警**：
  - [ ] 设置价格阈值
  - [ ] 触发通知（邮件/WebSocket）
  - [ ] 通知历史

- [ ] **数据同步**：
  - [ ] 定时任务（定时更新股票数据）
  - [ ] 增量更新
  - [ ] 数据版本管理

### 5.3 优先级

**P0 - 必须完成**：
- 量化交易算法平台（算法编辑器、算法管理）
- 实盘交易能力（券商 API 集成、交易执行引擎）
- 开放 API

**P1 - 重要**：
- 用户系统
- 风控管理
- 算法市场（可选）

**P2 - 可选**：
- 股票组合管理
- 价格预警
- 插件系统

### 5.4 验收标准

- [ ] 用户可以在系统内编辑和创建量化交易算法
- [ ] 算法可以正常运行回测
- [ ] 支持连接主流券商 API
- [ ] 实盘交易功能正常，交易延迟 < 100ms
- [ ] 开放 API 完整可用，提供 API 文档和 SDK
- [ ] 系统稳定性和安全性满足要求

---

## 6. 功能演进优先级

### 6.1 近期（1-3个月）

**P0 - 必须完成**：
1. Dashboard 页面开发
2. Stocks 列表页开发
3. Stock 详情页开发
4. 批量更新页开发

**P1 - 重要**：
1. 数据源扩展（Tushare、IEX Cloud）
2. 性能优化
3. 错误处理完善

### 6.2 中期（3-6个月）

**P0 - 必须完成**：
1. 预设量化交易算法（10+ 算法）
2. 回测引擎核心功能
3. 回测分析功能

**P1 - 重要**：
1. 回测可视化图表
2. 多策略组合回测
3. 历史数据管理

### 6.3 长期（6-12个月）

**P0 - 必须完成**：
1. 量化交易算法平台（算法编辑器、算法管理）
2. 实盘交易能力（券商 API 集成、交易执行引擎）
3. 开放 API

**P1 - 重要**：
1. 用户系统
2. 风控管理
3. 算法市场（可选）

---

## 7. 风险与应对

### 7.1 技术风险

**风险**：数据源不稳定，API 变更  
**应对**：多数据源容错，定期监控和更新

**风险**：性能瓶颈  
**应对**：性能测试，优化查询，添加缓存

### 7.2 业务风险

**风险**：需求变更  
**应对**：灵活架构，模块化设计，快速迭代

**风险**：用户反馈不足  
**应对**：MVP 验证，用户调研，持续改进

---

## 8. 成功指标

### 8.1 Phase 2 成功指标

- ✅ 所有核心页面开发完成
- ✅ 功能完整可用
- ✅ 系统性能满足要求
- ✅ 用户体验良好

### 8.2 Phase 3 成功指标

- ✅ 提供 10+ 预设量化投资算法
- ✅ 回测引擎可以正常运行
- ✅ 回测分析功能完整（收益、风险、交易分析）
- ✅ 回测可视化图表正常显示
- ✅ 回测性能满足要求（回测速度 < 1 分钟，单策略）

### 8.3 Phase 4 成功指标

- ✅ 用户可以在系统内编辑和创建量化交易算法
- ✅ 算法可以正常运行回测
- ✅ 支持连接主流券商 API
- ✅ 实盘交易功能正常，交易延迟 < 100ms
- ✅ 开放 API 完整可用，提供 API 文档和 SDK
- ✅ 系统稳定性和安全性满足要求

---

**文档维护**：本文档将根据项目进展持续更新

## 更新说明

### v1.2 更新内容（2025-01-20）

1. **数据支持模块状态更新**：
   - 前端基础实现完成（历史数据查询、技术指标展示）
   - 功能集成到股票详情页（Tab 方式），而非独立页面
   - 后端服务和 BFF 层标记为待实现
   - 数据质量检查和数据同步管理标记为暂缓实施
   - 更新验收标准和执行顺序

2. **技术文档归档**：
   - 7个数据支持模块相关技术方案和技术路线文档已归档到 `docs/archived/`
   - 创建实现总结文档：`数据支持模块-前端实现总结.md`

### v1.1 更新内容（2025-01-06）

1. **Phase 3 调整**：
   - 从"体验优化"调整为"量化交易算法与回测"
   - 增加预设量化交易算法（10+ 算法）
   - 增加回测引擎和回测分析功能
   - 移除响应式设计和多语言支持相关内容

2. **Phase 4 调整**：
   - 从"生态扩展"调整为"量化交易算法平台与实盘交易"
   - 增加量化交易算法平台（算法编辑器、算法管理、开放 API）
   - 增加实盘交易能力（券商 API 集成、交易执行引擎、风控管理）
   - 保留用户系统、股票组合管理、价格预警等高级功能
