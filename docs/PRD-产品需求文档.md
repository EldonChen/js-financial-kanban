# PRD - 产品需求文档

> **文档版本**：v1.1  
> **创建时间**：2025-01-06  
> **最后更新**：2025-01-06  
> **适用项目**：js-financial-kanban  
> **文档状态**：正式版

---

## 文档目录

1. [产品愿景](#1-产品愿景)
2. [功能架构设计](#2-功能架构设计)
3. [页面与交互层映射](#3-页面与交互层映射)
4. [Roadmap 规划](#4-roadmap-规划)
5. [附录](#5-附录)

---

## 1. 产品愿景

### 1.1 产品定位

**金融看板系统（Financial Kanban System）**是一个面向金融数据管理与分析的统一看板平台，为个人投资者、金融分析师和开发者提供：

- **多数据源股票信息管理**：统一管理来自不同数据源的股票信息
- **跨服务数据聚合**：聚合多个后端服务的数据，提供统一视图
- **灵活的数据操作**：支持 CRUD 操作、批量更新、实时数据同步
- **可扩展的架构**：支持多语言后端服务、多数据源适配、BFF 层聚合

### 1.2 目标用户

- **个人投资者**：快速查看和管理关注的股票信息
- **金融分析师**：获取和分析多市场股票数据
- **开发者/技术爱好者**：学习和实践多语言后端架构、BFF 模式

### 1.3 核心问题

- **数据分散问题**：股票数据分散在多个数据源，格式不统一
- **服务集成问题**：多个后端服务数据格式不一致
- **数据同步问题**：股票数据需要手动更新，无法实时同步

### 1.4 产品愿景

**长期愿景（1-2年）**：成为个人投资者和量化交易者首选的量化交易算法平台
- 提供开放 API，允许用户在系统内编辑和创建量化交易算法
- 支持实盘交易能力，连接主流券商 API
- 提供算法市场，支持算法分享和交易

**中期愿景（6-12个月）**：构建完整的金融数据管理与量化交易生态系统
- 提供 10+ 预设量化投资算法
- 完整的回测引擎和回测分析功能
- 支持多策略组合回测

**近期愿景（3-6个月）**：完成核心功能，提供可用的 MVP（最小可行产品）

> 详细内容请参考：[PRD-产品愿景.md](./PRD-产品愿景.md)

---

## 2. 功能架构设计

### 2.1 架构层级

```
前端层 (Frontend)
    ↓ HTTP
BFF 层 (Backend For Frontend)
    ↓ HTTP
后台服务层 (Backend Services)
    ↓
数据层 (MongoDB)
```

### 2.2 功能模块划分

#### 2.2.1 核心能力模块

- **股票信息管理模块**：提供股票信息的完整生命周期管理
- **数据聚合模块**：聚合多个后端服务的数据，提供统一视图
- **实时同步模块**：提供实时数据同步和进度追踪

#### 2.2.2 支撑型模块

- **多数据源适配模块**：支持多个股票数据源，自动切换和容错
- **BFF 视图模块**：为前端提供定制化的视图接口
- **数据转换模块**：统一不同服务的数据格式

#### 2.2.3 可扩展/实验性模块

- **数据分析模块**（规划中）：提供股票数据分析和可视化
- **用户系统模块**（规划中）：支持多用户、权限管理
- **通知模块**（规划中）：提供价格预警和通知功能

### 2.3 模块关系

- **依赖关系**：前端 → BFF → 后台服务 → 数据层
- **数据流**：用户操作 → 前端页面 → BFF 视图 → 后台服务 → 数据层

> 详细内容请参考：[PRD-功能架构设计.md](./PRD-功能架构设计.md)

---

## 3. 页面与交互层映射

### 3.1 页面层级结构

```
金融看板系统
├── 首页（Dashboard）
├── 股票管理
│   ├── 股票列表页
│   ├── 股票详情页
│   └── 股票更新页（批量操作）
├── Items 管理（可选）
│   └── Items 列表页
└── 设置
    ├── 账户设置
    ├── 外观设置
    └── 通知设置
```

### 3.2 核心页面

#### 3.2.1 Dashboard（首页）

- **路径**：**`/` 或 `/dashboard`**
- **功能**：系统概览，展示所有服务的统计信息和最近数据
- **API**：`GET /api/bff/v1/views/dashboard`

#### 3.2.2 Stocks 列表页

- **路径**：`/stocks` 或 `/stocks/list`
- **功能**：股票列表，支持搜索、筛选、分页
- **API**：`GET /api/bff/v1/views/stocks`

#### 3.2.3 Stock 详情页

- **路径**：`/stocks/{ticker}` 或 `/stocks/detail?ticker=AAPL`
- **功能**：单个股票的详细信息
- **API**：`GET /api/bff/v1/views/stocks/{ticker}`

#### 3.2.4 批量更新页

- **路径**：`/stocks/batch-update` 或 `/stocks/update`
- **功能**：批量更新股票数据，支持实时进度追踪
- **API**：`POST /api/v1/stocks/fetch-all?delay=1.0`（SSE）

### 3.3 导航结构

```
侧边栏导航（Sidebar）
├── 🏠 Dashboard（首页）
├── 📈 Stocks（股票管理）
│   ├── 股票列表
│   └── 批量更新
├── 📋 Items（可选）
└── ⚙️ Settings（设置）
```

> 详细内容请参考：[PRD-页面与交互层映射.md](./PRD-页面与交互层映射.md)

---

## 4. Roadmap 规划

### 4.1 阶段划分

- **Phase 1：MVP 核心功能**（✅ 已完成）
- **Phase 2：功能完善**（🚧 进行中）
- **Phase 3：体验优化**（🔮 规划中）
- **Phase 4：生态扩展**（🔮 规划中）

### 4.2 Phase 2：功能完善（部分完成）

**时间范围**：2025 Q1 - Q2  
**状态**：🚧 进行中（前端页面开发已完成 ✅）

**交付内容**：

1. **前端页面开发** ✅ **已完成**（2025-01-11）：
   - ✅ Dashboard 页面（统计数据展示、最近数据列表、数据刷新）
   - ✅ Stocks 列表页（列表展示、搜索、筛选、排序、分页、批量操作）
   - ✅ Stock 详情页（详细信息展示、更新/删除操作）
   - ✅ 批量更新页（SSE 实时进度追踪、进度可视化）

2. **功能增强** 🚧 **进行中**：
   - [ ] 数据源扩展（Tushare、IEX Cloud、Alpha Vantage）
   - [ ] 性能优化（缓存策略、查询优化）
   - [ ] 错误处理完善（统一错误响应格式）

3. **测试和文档** 🚧 **进行中**：
   - [ ] 单元测试（前端组件、BFF 层服务）
   - [ ] 集成测试（端到端测试、API 集成测试）
   - [ ] 文档完善（API 文档、用户手册、开发文档）

### 4.3 Phase 3：量化交易算法与回测（规划中）

**时间范围**：2025 Q2 - Q3  
**状态**：🔮 规划中

**交付内容**（按优先级排序）：

1. **数据支持模块** 🔮 **P0 - 最高优先级**：
   - **历史K线数据获取与存储**：
     - 多数据源集成（yfinance、akshare）
     - 多时间周期支持（1分钟到月线）
     - 批量数据获取和增量更新
     - 数据存储和索引优化
   - **历史数据质量保证**：
     - 数据质量检查（完整性、准确性、一致性）
     - 数据修复机制（自动修复、修复记录）
     - 数据验证（格式、范围、时间验证）
   - **技术指标计算**：
     - 基础技术指标（MA、RSI、MACD、布林带等）
     - 高级技术指标（KDJ、OBV、CCI、ATR等）
     - 指标计算引擎和缓存
     - 指标数据管理和可视化
   - **数据服务接口**：
     - 后端服务开发（历史数据服务、技术指标服务）
     - BFF 层集成（历史数据视图、技术指标视图）
     - 前端界面开发（数据管理页、指标计算页）
   - **数据同步与更新**：
     - 定时任务（每日数据同步、质量检查）
     - 数据同步策略（按市场、按优先级）
     - 同步进度追踪
   - **实时交易情况获取** 🔮 **P1 - 重要**：
     - **实时行情数据获取**：
       - 多数据源集成（easyquotation、yfinance、akshare）
       - 实时数据获取方式（WebSocket 推送、轮询方式）
       - 实时行情数据类型（基础行情、五档买卖盘、逐笔成交）
     - **实时数据订阅与管理**：
       - 订阅机制（单只、批量、市场、自定义订阅）
       - 订阅管理功能（订阅列表、状态查询、配置管理）
       - 数据推送策略（全量/增量推送、频率控制）
     - **实时数据存储与缓存**：
       - 数据存储设计（MongoDB、Redis 缓存）
       - 数据缓存策略（热点数据缓存、缓存更新）
       - 数据查询接口（单只、批量、市场查询）
     - **WebSocket 服务与连接管理**：
       - WebSocket 服务设计（连接认证、状态管理、心跳检测）
       - 连接管理功能（连接池、限流、监控、异常处理）
       - 消息协议设计（订阅、推送、心跳消息格式）
     - **实时数据服务接口**：
       - 后端服务开发（实时数据服务、WebSocket 服务）
       - BFF 层集成（实时数据视图、WebSocket 代理）
       - 前端界面开发（实时行情展示、订阅管理）
     - **性能优化与容错**：
       - 性能优化（数据压缩、批量推送、连接复用）
       - 容错机制（故障切换、自动重连、降级策略）
       - 监控与告警（连接监控、数据推送监控、异常告警）

2. **回测引擎** 🔮 **P0 - 必须完成**（依赖数据支持）：
   - 回测核心功能（历史数据回测、多时间周期、自定义参数）
   - 回测分析功能（收益分析、风险分析、交易分析）
   - 回测可视化图表（收益曲线、回撤曲线、持仓分布、交易信号）

3. **预设量化交易算法** 🔮 **P0 - 必须完成**（依赖数据支持和技术指标）：
   - 算法库开发（10+ 预设算法：均线、动量、均值回归、配对交易等）
   - 算法管理（算法列表、详情、参数配置、版本管理）

4. **量化交易服务** 🔮 **P1 - 重要**：
   - 后端服务开发（算法执行引擎、回测引擎、数据接口）
   - 前端界面开发（算法列表页、详情页、回测配置页、结果页、分析页）

### 4.4 Phase 4：生态扩展（规划中）

**时间范围**：2025 Q3 - Q4

**交付内容**：

1. **用户系统**：
   - 用户认证（注册/登录、JWT）
   - 权限管理（角色和权限、数据隔离）
   - 个人设置（用户偏好、通知设置）

2. **高级功能**：
   - 股票组合管理
   - 价格预警
   - 数据同步（定时任务、增量更新）

3. **开放生态**：
   - API 开放
   - 插件系统
   - 集成能力（Webhook、第三方集成）

> 详细内容请参考：[PRD-Roadmap规划.md](./PRD-Roadmap规划.md)

---

## 5. 附录

### 5.1 相关文档

- [PRD-产品愿景.md](./PRD-产品愿景.md) - 产品愿景和定位
- [PRD-功能架构设计.md](./PRD-功能架构设计.md) - 功能架构设计
- [PRD-页面与交互层映射.md](./PRD-页面与交互层映射.md) - 页面与交互设计
- [PRD-Roadmap规划.md](./PRD-Roadmap规划.md) - Roadmap 规划

### 5.2 技术文档

- [技术方案设计-BFF层.md](./技术方案设计-BFF层.md) - BFF 层技术方案
- [API文档-股票信息服务.md](./API文档-股票信息服务.md) - 股票信息服务 API
- [BFF-API-规范.md](./BFF-API-规范.md) - BFF API 规范

### 5.3 项目信息

- **项目名称**：js-financial-kanban
- **技术栈**：
  - 前端：Nuxt.js 4 + Vue 3 + Shadcn UI + Tailwind CSS
  - BFF：NestJS
  - 后端：Python FastAPI、Node.js Nest.js、Rust Axum
  - 数据库：MongoDB

### 5.4 联系方式

- **项目仓库**：GitHub（待补充）
- **文档维护**：本文档将根据产品发展持续更新

---

**文档版本历史**：

- **v1.1**（2025-01-06）：更新产品愿景，增加量化交易算法与回测能力（中期），增加量化交易算法平台与实盘交易能力（长期）
- **v1.0**（2025-01-06）：初始版本，包含产品愿景、功能架构、页面映射、Roadmap 规划

---

**最后更新**：2025-01-06  
**维护者**：项目团队

## 更新说明

### v1.1 更新内容（2025-01-06）

1. **中期愿景调整**：
   - 增加"预设量化交易算法与回测"能力
   - 预期提供 10+ 量化投资算法
   - 完整的回测能力和回测分析功能

2. **长期愿景调整**：
   - 移除多语言支持和响应式设计
   - 增加"量化交易算法平台与实盘交易"能力
   - 提供开放 API，允许用户编辑算法并运行回测
   - 增加实盘交易能力
